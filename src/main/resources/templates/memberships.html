<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4"
      lang="en">
<head th:replace="header :: copy(headingTitle='UH Groupings Membership')"></head>
<body ng-app="UHGroupingsApp">
<nav th:substituteby="menubar :: copy"></nav>

<!--  Content container -->
<div class="container">
    <div class='row'>
        <div class='container-fluid' ng-controller="MembershipJsController" data-ng-init="init()">
            <h1 class="text-left">Manage My Memberships</h1>

            <!-- <p th:text="#{screen.message.home.test('{{currentUsername}}')}">Hi my name is aaron</p> -->

            <p class="text-left">View and manage my memberships. Search for new groupings to join as a member.</p>

            <ul class="nav nav-tabs " id="memTab">
                <li role="presentation" class="active" data-toggle="tooltip" data-placement="top">
                    <a href="#belong" data-toggle="tab" role="tab">
                        <!--<i class="fa fa-users fa-3x" aria-hidden="true"></i>-->
                        Current Memberships
                    </a>
                </li>
                <li role="presentation" data-toggle="tooltip" data-placement="top">
                    <a href="#optOut" data-toggle="tab" role="tab">
                        <!--<i class="fa fa-user-plus fa-3x" aria-hidden="true"></i>-->
                        Membership Opportunities
                    </a>
                </li>
            </ul>
            <div id="overlay" ng-show="loading">
                <div class="loader" ng-show="loading"></div>
            </div>

            <!-- Content that should be viewed by the nav tabs -->
            <div class="tab-content">
                <div class="tab-pane fade in active" id="belong">
                    <div class="panel panel-default panel-tab-content">
                        <div class="panel-heading">
                            <div class="row" style="margin: inherit">
                                <div class="col-md-6 col-sm-7" style="padding: 0px;">
                                    <h2 class = "panel-title" style="padding: 2.5px 0px; margin: inherit;">My Grouping Memberships</h2>
                                    <span>Some memberships are optional, and some are required.</span>
                                </div>
                                <div class="col-md-push-3 col-md-3 col-sm-push-1 col-sm-4" style="padding: 0px;">
                                   <input name = "memberFilt" placeholder="Filter Groupings..." type="text" title ="Filter Groupings"
                                                      ng-model="queryMembers" class="form-control"
                                                      ng-change="filter(membersList, 'pagedItemsMembersList', 'currentPageOptOut', 'queryMembers')"
                                                      id="members"/>
                                </div>
                            </div>
                        </div>
                        <div class = "table-responsive">
                            <table class="table table-responsive table-bordered table-condensed table-hover">
                                <thead>
                                <tr>
                                    <th ng-click="sortBy('membersList', 'pagedItemsMembersList', 'name')" class="clickable">
                                        Grouping Name
                                        <i class="fa sort-icon" ng-show="columnSort.membersList.property === 'name' || !columnSort.membersList" ng-class="{ reverse: columnSort.membersList.reverse }"></i>
                                    </th>
                                    <th ng-click="sortBy('membersList', 'pagedItemsMembersList', 'path')" class="clickable">
                                        Grouping Path
                                        <i class="fa sort-icon" ng-show="columnSort.membersList.property === 'path'" ng-class="{ reverse: columnSort.membersList.reverse }"></i>
                                    </th>
                                    <th class="col-md-2 text-center" style="vertical-align: middle;">Opt Out?</th>
                                </tr>
                                </thead>
                                <tfoot>

                                <!-- Top part of the two parts  -->
                                <td colspan="6">
                                    <ul class="pagination pull-right" aria-live = "assertive">
                                        <li ng-class="{disabled: (currentPageOptOut) == 0}">
                                            <a class="clickable" ng-click="currentPage('First','pagedItemsMembersList','currentPageOptOut')">«« First</a>
                                        </li>
                                        <li ng-class="{disabled: (currentPageOptOut) == 0}">
                                            <a class="clickable" ng-click="currentPage('Prev','pagedItemsMembersList','currentPageOptOut')">« Prev</a>
                                        </li>
                                        <li ng-repeat="n in range(pagedItemsMembersList.length, currentPageOptOut - gap, currentPageOptOut + gap + 1) "
                                            ng-class="{active: n == currentPageOptOut}"
                                            ng-click="currentPage('Set','pagedItemsMembersList','currentPageOptOut')">
                                            <a class="clickable" ng-bind="n + 1">1</a>
                                        </li>
                                        <li ng-class="{disabled: ((currentPageOptOut) == pagedItemsMembersList.length - 1) || pagedItemsMembersList.length == 0}">
                                            <a class="clickable" ng-click="currentPage('Next','pagedItemsMembersList','currentPageOptOut')">Next »</a>
                                        </li>
                                        <li ng-class="{disabled: ((currentPageOptOut) == pagedItemsMembersList.length - 1) || pagedItemsMembersList.length == 0}">
                                            <a class="clickable" ng-click="currentPage('Last','pagedItemsMembersList','currentPageOptOut')">Last »»</a>
                                        </li>
                                    </ul>
                                </td>
                                </tfoot>
                                <tbody>
                                <tr ng-repeat="l in pagedItemsMembersList[currentPageOptOut] ">
                                    <td>{{l.name}}</td>
                                    <td>{{l.path}}</td>
                                    <td class="col-md-2 col-sm-2 col-xs-2">
                                        <div ng-if="required($index+(currentPageOptIn * itemsPerPage))">
                                            <p align="center">Membership Required</p>
                                        </div>
                                        <div ng-if="!required($index+(currentPageOptIn * itemsPerPage))">
                                            <button id="optOutButton" class="btn btn-primary btn-block opt-button text-center"
                                                    tabindex="0"
                                                    ng-click="optOut($index)"
                                                    ng-attr-title="{{ tooltipText($index + (currentPageOptIn * itemsPerPage)) }}">
                                                Opt Out
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>


                <!-- Divide between the tabs  -->
                <div class="tab-pane fade" id="optOut">
                    <div class="panel panel-default panel-tab-content">
                        <div class="panel-heading">
                            <div class="row" style="margin: inherit;">
                                <div class="col-md-6 col-sm-7" style="padding: 0px;">
                                    <h2 class = "panel-title" style="padding: 2.5px 0px; margin: inherit;">Available Groupings</h2>
                                    <span>You may opt in to any of these groupings to become a member.</span>
                                </div>
                                <div class="col-md-push-3 col-md-3 col-sm-push-1 col-sm-4" style="padding: 0px;">
                                  <input name = "optIn" placeholder="Filter Groupings..." type="text" title="Filter Groupings"
                                                   ng-model="queryOptIn" class="form-control"
                                                   ng-change="filter(optInList, 'pagedItemsOptInList', 'currentPageOptIn', 'queryOptIn')"
                                                   id="optIn"/>
                                </div>
                            </div>
                        </div>
                        <div class="table-responsive">
                            <table class="table table-bordered table-condensed table-hover" aria-live="assertive">
                                <thead>
                                <tr>
                                    <th ng-click="sortBy('optInList', 'pagedItemsOptInList', 'name')" class="clickable">
                                        Grouping Name
                                        <i class="fa sort-icon" ng-show="columnSort.optInList.property === 'name' || !columnSort.optInList" ng-class="{ reverse: columnSort.optInList.reverse }"></i>
                                    </th>
                                    <th ng-click="sortBy('optInList', 'pagedItemsOptInList', 'path')" class="clickable">
                                        Grouping Path
                                        <i class="fa sort-icon" ng-show="columnSort.optInList.property === 'path'" ng-class="{ reverse: columnSort.optInList.reverse }"></i>
                                    </th>
                                    <th class="col-md-2 text-center" style="vertical-align: middle;">Opt In?</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr ng-repeat="o in pagedItemsOptInList[currentPageOptIn] ">
                                    <td>{{o.name}}</td>
                                    <td id = "groupingOptInPath">{{o.path}}</td>
                                    <td class="col-md-2">
                                        <button ng-disabled="disableOptIn($index + (currentPageOptOut * itemsPerPage))" class="btn btn-primary btn-block opt-button"
                                                tabindex="0"
                                                ng-click="optIn($index)">Opt In
                                        </button>
                                    </td>
                                </tr>
                                </tbody>
                                <tfoot>
                                <td colspan="6">
                                    <ul class="pagination pull-right">
                                        <li ng-class="{disabled: (currentPageOptIn) == 0 }">
                                            <a class="clickable" ng-click="currentPage('First','pagedItemsOptInList','currentPageOptIn')">«« First</a>
                                        </li>
                                        <li ng-class="{disabled: (currentPageOptIn) == 0}">
                                            <a class="clickable" ng-click="currentPage('Prev','pagedItemsOptInList','currentPageOptIn')">« Prev</a>
                                        </li>
                                        <li ng-repeat="n in range(pagedItemsOptInList.length, currentPageOptIn - gap, currentPageOptIn + gap + 1) "
                                            ng-class="{active: n == currentPageOptIn}"
                                            ng-click="currentPage('Set','pagedItemsOptInList','currentPageOptIn')">
                                            <a class="clickable" ng-bind="n + 1">1</a>
                                        </li>
                                        <li ng-class="{disabled: ((currentPageOptIn) == pagedItemsOptInList.length - 1) || pagedItemsOptInList.length == 0}">
                                            <a class="clickable" ng-click="currentPage('Next','pagedItemsOptInList','currentPageOptIn')">Next »</a>
                                        </li>
                                        <li ng-class="{disabled: ((currentPageOptIn) == pagedItemsOptInList.length - 1) || pagedItemsOptInList.length == 0}">
                                            <a class="clickable" ng-click="currentPage('Last','pagedItemsOptInList','currentPageOptIn')">Last »»</a>
                                        </li>
                                    </ul>
                                </td>
                                </tfoot>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- to map out  CurrentWindow * (WindowSize - 1) + 1 -->


<!-- / Content container. -->

<div th:substituteby="footer :: copy"></div>

</body>
</html>
