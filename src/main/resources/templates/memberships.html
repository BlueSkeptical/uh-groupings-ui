<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">
<head th:substituteby="header :: copy"></head>
<body ng-app="membershipApp">
<nav th:substituteby="menubar :: copy"></nav>

<!--  Content container -->
<div class="container">
    <div class='row'>
        <div class='container-fluid' ng-controller="MembershipJsController" data-ng-init="init()">
            <h1 class="text-left">Manage My Memberships</h1>

            <p class="text-left">View and manage my memberships.  Search for new Groupings to join as a member.</p>

            <ul class="nav nav-tabs " id="memTab">
                <li role="presentation" class="active" data-toggle="tooltip" data-placement="top" title="My memberships">
                    <a href="#belong" data-toggle="tab" role="tab">
                        <i class="fa fa-users fa-3x" aria-hidden="true"></i>

                    </a>
                </li>
                <li role="presentation" data-toggle="tooltip" data-placement="top" title="Additional membership opportunities">
                    <a href="#optOut" data-toggle="tab" role="tab">
                        <i class="fa fa-user-plus fa-3x" aria-hidden="true"></i>
                    </a>
                </li>
            </ul>
            <div id="overlay" ng-show="loading">
                <div class="loader" ng-show="loading"></div>
            </div>

            <!-- Content that should be viewed by the nav tabs -->
            <div class="tab-content">
                <div class="tab-pane fade in active" id="belong">
                    <div class="panel panel-default panel-tab-content">
                        <div class="panel-heading">
                            <div class="row" style="margin: inherit">
                                <div class="col-md-6 col-sm-7" style="padding: 0px;">
                                    <h3 style="padding: 2.5px 0px; margin: inherit;">My Grouping Memberships</h3>
                                    <span>Some memberships are optional, and some are required.</span>
                                </div>
                                <div class="col-md-push-3 col-md-3 col-sm-push-1 col-sm-4" style="padding: 0px;">
                                    <input placeholder="Filter Groupings..." type="text"
                                           ng-model="queryMembers" class="form-control"
                                           ng-change="search(membersList, 'pagedItemsMembersList', 'queryMembers')"
                                           id="members"/>
                                </div>
                            </div>
                        </div>
                        <table class="table table-bordered table-condensed table-hover">
                            <thead>
                            <tr>
                                <th><a type="button" class="btn btn-default btn-block"
                                       style="padding-left: 0px; text-align: left; width: 100%; border: none"
                                       ng-click="sort(membersList, 'name', 'pagedItemsMembersList', 'symbolList')"><b>Grouping Name
                                    {{symbol.member}}</b></a></th>
                                <th class="col-md-2" style="vertical-align: middle;">Opt Out</th>
                            </tr>
                            </thead>
                            <tfoot>

                            <!-- Top part of the two parts  -->
                            <td colspan="6">
                                <ul class="pagination pull-right">
                                    <li ng-class="{disabled: (currentPageOptOut) == 0}">
                                        <a href=""
                                           ng-click="currentPage('First','pagedItemsMembersList','currentPageOptOut')">«
                                            First</a>
                                    </li>
                                    <li ng-class="{disabled: (currentPageOptOut) == 0}">
                                        <a href=""
                                           ng-click="currentPage('Prev','pagedItemsMembersList','currentPageOptOut')">«
                                            Prev</a>
                                    </li>
                                    <li ng-repeat="n in range(pagedItemsMembersList.length, currentPageOptOut - gap, currentPageOptOut + gap + 1) "
                                        ng-class="{active: n == currentPageOptOut}"
                                        ng-click="currentPage('Set','pagedItemsMembersList','currentPageOptOut')"
                                            ><a href="" ng-bind="n + 1">1</a>
                                    </li>
                                    <li ng-class="{disabled: ((currentPageOptOut) == pagedItemsMembersList.length - 1) || pagedItemsMembersList.length == 0}">
                                        <a href=""
                                           ng-click="currentPage('Next','pagedItemsMembersList','currentPageOptOut')">Next
                                            »</a>
                                    </li>
                                    <li ng-class="{disabled: ((currentPageOptOut) == pagedItemsMembersList.length - 1) || pagedItemsMembersList.length == 0}">
                                        <a href=""
                                           ng-click="currentPage('Last','pagedItemsMembersList','currentPageOptOut')">Last
                                            »</a>
                                    </li>
                                </ul>
                            </td>
                            </tfoot>
                            <tbody>
                            <tr ng-repeat="l in pagedItemsMembersList[currentPageOptOut] ">
                                <td>{{l.name}}</td>
                                <td class="col-md-2">
                                    <button id="optOutButton" class="btn btn-primary btn-block opt-button"
                                            ng-click="optOut($index + (currentPageOptIn * itemsPerPage))" ng-disabled="disableOptOut($index + (currentPageOptIn * itemsPerPage))"
                                            ng-attr-title="{{ tooltipText($index + (currentPageOptIn * itemsPerPage)) }}">
                                        Opt Out
                                    </button>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>


                <!-- Divide between the tabs  -->
                <div class="tab-pane fade" id="optOut">
                    <div class="panel panel-default panel-tab-content">
                        <div class="panel-heading">
                            <div class="row" style="margin: inherit;">
                                <div class="col-md-6" style="padding: 0px;">
                                    <h3 style="padding: 2.5px 0px; margin: inherit;">Available Groupings</h3>
                                    <span>You may opt-in to any of these Groupings to become a member.</span>
                                </div>
                                <div class="col-md-push-3 col-md-3" style="padding: 0px;">
                                    <input placeholder="Filter Groupings..." type="text"
                                           ng-model="queryOptIn" class="form-control"
                                           ng-change="search(optInList, 'pagedItemsOptInList', 'queryOptIn')"
                                           id="optIn"/>
                                </div>
                            </div>
                        </div>

                        <table class="table table-bordered table-condensed table-hover">
                            <thead>
                            <tr>
                                <th><a type="button" class="btn btn-default btn-block"
                                       style="padding-left: 0px; text-align: left; width: 100%; border: none"
                                       ng-click="sort(optInList, 'name', 'pagedItemsOptInList', 'symbolOptIn')"><b>Grouping Name
                                    {{symbol.optInName}}</b></a></th>
                                <th><a type="button" class="btn btn-default btn-block"
                                       style="padding-left: 0px; text-align: left; width: 100%; border: none"
                                       ng-click="sort(optInList, 'path', 'pagedItemsOptInList', 'symbolOptIn')"><b>Grouping Path
                                    {{symbol.optInPath}}</b></a></th>
                                <th class="col-md-2" style="vertical-align: middle;">Opt in</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr ng-repeat="o in pagedItemsOptInList[currentPageOptIn] ">
                                <td>{{o.name}}</td>
                                <td>{{o.path}}</td>
                                <td class="col-md-2">
                                    <button ng-disabled="disableOptIn($index + (currentPageOptOut * itemsPerPage))" class="btn btn-primary btn-block opt-button"
                                            ng-click="optIn($index + (currentPageOptOut * itemsPerPage))">Opt In
                                    </button>
                                </td>
                            </tr>
                            </tbody>
                            <tfoot>
                            <td colspan="6">
                                <ul class="pagination pull-right">
                                    <li ng-class="{disabled: (currentPageOptIn) == 0 }">
                                        <a href=""
                                           ng-click="currentPage('First','pagedItemsOptInList','currentPageOptIn')">«
                                            First</a>
                                    </li>
                                    <li ng-class="{disabled: (currentPageOptIn) == 0}">
                                        <a href=""
                                           ng-click="currentPage('Prev','pagedItemsOptInList','currentPageOptIn')">«
                                            Prev</a>
                                    </li>
                                    <li ng-repeat="n in range(pagedItemsOptInList.length, currentPageOptIn - gap, currentPageOptIn + gap + 1) "
                                        ng-class="{active: n == currentPageOptIn}"

                                        ng-click="currentPage('Set','pagedItemsOptInList','currentPageOptIn')"
                                            ><a href="" ng-bind="n + 1">1</a>
                                    </li>
                                    <li ng-class="{disabled: ((currentPageOptIn) == pagedItemsOptInList.length - 1) || pagedItemsOptInList.length == 0}">
                                        <a href=""
                                           ng-click="currentPage('Next','pagedItemsOptInList','currentPageOptIn')">Next
                                            »</a>
                                    </li>
                                    <li ng-class="{disabled: ((currentPageOptIn) == pagedItemsOptInList.length - 1) || pagedItemsOptInList.length == 0}">
                                        <a href=""
                                           ng-click="currentPage('Last','pagedItemsOptInList','currentPageOptIn')">Last
                                            »</a>
                                    </li>
                                </ul>
                            </td>
                            </tfoot>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- to map out  CurrentWindow * (WindowSize - 1) + 1 -->


<!-- / Content container. -->

<div th:substituteby="footer :: copy"></div>

</body>
</html>
